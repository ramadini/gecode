#include <gecode/string.hh>
#include <gecode/driver.hh>
#include <math.h>

using namespace Gecode;
using namespace String;

string
W = "RFBQVPZ0AQEHMVZYXVTWGUPXI3TPPAOB8W4ZMIZZK0SQS1UOKFX3AJTR5UJUN351ZMJEBU5PRSL1XJFORBH40ABP5VCFARAGZRKCTGOUUI0VGCRTLUZ5KRME9OTINYANEMZIZ5GRQGCKSM5ITLQEJTJWUNAVQPC6DKLJORZNFK0IAZNUKSQO7MFL9MWISTEQ9JWQUJEK95WNTPSJ1H0UQYBCYHZNQ8TKXA6NMHTFHXAPYLYYSTIWPH5TPA980HPEEGXDJQRPCAPW78E1UKISOYJDCIDUF2C29LC5CSUX4NCOA4AZMPGUMC1XHD9BVDBV81D3ROHPECPJSQKA5SQ8FY4EWV9U06UBB7X92RPIAI3G1F0TXQC6V0JZHT0NSPN1DGZQIXTOZXMKUY6XRMU7LSHNQAKBYZOAIC8YMKIIZLYOT2MQATNHCEW9ESSTATIBH8ARMBR0HZGVTJQHCJ1TH2BACEGIBS8UYSKNP25PM2B2HBWZIMAYPJS1GSS6YLUVWMWBGYXLMVGAQ1QILRMKOSYKJCVGNMQKWLDO6Q4I7C2K2XKFN5VBZELKVMP5RRFKEXZYHMJPEKFD1YZNWSIUPRXZXCHAEBCIXUEM62EISFDNSM7RKSQCOEWUCXANLX4FFQK1BCR4WPLKHARCPZTUXP22MZ8I0UUGQ8RVTGYE894RHG3J2R6Y52IFTI7U4BOFCDLLECV43HTCQRUHAPRA4TVTFCPIFWRGZQTPSMC2FTH99US0KZCZOJYR7FK0O8MAA7UPACWHEZS7HYNKDQNRK1Z7HCTCBCWJQCVCYCUQJPRNVOITCSXX54DMU3GFPSCYUYMRZMQLIOFQ3ZICDBSBRESLO2IKZJETGFMNEU0U1L20ANPDKYJXWKCGQAUFDNPYO0XDWY8A8TGWJ0B34UAWP74M2B9UNTDVHFOCZJ5IYAI6IVCPXP3VCIIYOWPOTGJ1ZNHHW1OX1TFCXDBBHSVKAAUBKVR1DO0LSLUZRCF1LVWYKSPJWHICYC6UOCP32KNSNA3FK6U0NXMBQKZLJ7CN6741JPEJMRLJ6HYUOTIYPYUF4C8LASYA18JGLJBVX03N25QNXC6MFTFEDBUPRD7SZRMSBJVXGEFYQUH83VWF0USNN4QGUSRWXER8GEMEKEI4MEA7WB2DPT5JXSTYQKI07OQCWUPPDC03W13QAWRIW1AUKWJ8ZZWXMUBUXEX7BPFZFCHOTKX2X1SZ9JHLMHD8TCXCTCBWZHDNJKNSNFFDQIFKEH1MBOCSIN8BFIE9IUGKSF9AVTRQC3JY6DWJTR1MAQB5HOJQHBVOCIDZRHNYRX50CGRK4W1TBBE4LY9JUVIFRJ014UXW5ZFROA7PTSLEVRKXEJVMIPPXE81JVQUVON2UYFAHRPRMMJGN35NGPMZOMMDKH1S3FIEGCKHZCNQKZQCK0CO1EU6FT2EIQJXOMSJVEPUHIAD9NNVYA9CZV9GTJQPA3VBOZWBZIOYXCKFR2YTI2MY0NQQZVG93RNEDIS1TROXLDK2HS8EIVDHOSVMQSZJOXDBKCS58SEHFLIIS7IIICK4Q0AOM2ZVBLVJVCSUCYBUPMLGEZJKFWIOJUGV95UPOGRGXHHKUZOELYHNA1MATIGAGE1N3KJTAGPQ8ACLH2DY44KIKQIVEJB7ASMIZQKOUAUOVGVVJUWG0TSOD0QRRXQIBNQYIRIBQH15W5J8EKHGSMKB84PZYJRP7EXLX04TS5RE5RMMMK7EKDSZ0QEVBLORK2DGNCAZJRQITF42MO8CBCEHFHGWVXGE1BY5OZOKLBHEN1ENTUWUVFA36HQGFJUWTOSA0YEOJIX5YV4ZJISMTX7S1WVWAPTZRKA3BTFN5S1RAHCTYNHGW7LYTVWL0M3TFSOUOYRVZPAEAGM3T34MPAYNCFQPYLINSUWHJOSLIFDZ6UFY7YVARK2QXUTVVFHCWC5YRQHZI1RDL5OYW8AU7YOTCZIUZB5KIJAYX86DULGJEHCUW9ITZFGEXUYPB12SNIISNFFJ3RPNT2H8FH1UHAHBXDB2URISLW1PLMEJYIFSGSGKXHXIOGGFKPJEXJEONYDJBCJSRZF81OC3RT3PHEB8A4MOAQ9UGRYJLX06IYL8CKBTVSJ5SPB6JACW5U7CYQQZKIDGGHR9I1CBVWTISILGSAS7Q3EAWK3SHMLVZIW3UQFAELZ7XNALJBFP9PQ1NQGCO59HHWRZ2S0QHWRVKK3CJ4C75ABWXXCGSKRQS3LBWVYK9QPO0JISTOE9TOMIMW4QARLBOEQGJ8FTLLFUK0SM350XU42AHQZIYN2TIHR8IPLHPH2ZCOZRD4K408MSRQSZHHKWABWTUIKOJMDPHUZRA28CP6YRLUDG1HAGXWKOLZORKHTLQUHKCRGHCLOFLG9LPS3WOVFQMSOKCSZ5ZARURMLCTLMIJZAZKTQ5IKXF17EGHTICCA4UZT3WFBRBXNGSOPXO4ACFFWUOWNEJGC8RRRYIKSN9VHZS4TRJJOIHF1OZN59LPO9OQIOHK8OIW3TFLIYR2P3KTC72Y7SWMTDS4LA7FVXTNFHSMHWMQQH9ERNWI4F2JIFYKMT4I5JHXWJTVYPJMLH9CUQJG82EJKYNFTHYNPEAIQVZDD84SMLJXZDPRP3CL9YX0GUK5DSY7VXQQ01ISVYWPR0CANRFFWHLPPRA9WSCCVB6SRPNHS9V3MKMARSZ08EYMZOPWBCGTEPVSOGRYMKYYYOOYICGAQC1OGYFQMHUWWT7FV88IFRYWGKD8EFSEPGGJ7Z7RTDHFBNJLUVUIIE85QAR9RV9MAKXAR4WXTFMN7OIPOU9H8YFEIE8V5UQ6OXH9JOWZ3X0PO5M6D5SZXVEGTPFZ9XCWIAPDGL1BJPJDHNXKTCIU8LXBSCMC2MFEHYSTBQNO37LSNNI5T9AGHGBINWT407NHCXOXW4G5GRNUUH0M1NNQAFHQZG2A4BP0FCW44CJWXRF6DTM7VCRI5BBGTWY7MVIEUUNGGTPZ7YJI4KOQPQBTFSUEAZSDGZ9TYFF2KZQYOEZZTOGDNHRGOQ1BUSWDM2EWNSCYETZLALGFKFVBSPZGDLJYQLZZ6ZQPESBPVBMVOHLMMG2NCLI1N16MT0F2BAEA8J3BRNZ3NTHS4WRWIRLHHAPWBJ9YVJIW4NMYKZGJOOTAGNNSQJWICBCCLYGF5CHLNYWHFIB64ZO8MAS5GKSDHWEQLTQ1HPN4DRXSRMVE0GXI7CPALAGTEKWLSSDNK5SFUPYM54TQ7DWRVBEKKSYGSG4CO8W0IZGC58MBE7AIY13EHSJHHILJKH6FH686HCRO1RPJMHFWCHHZM0KVCWN86ZMQTRIZQO69SXCIEHOOIPLUHVZJEAN391FKB06RBTV1UYEQI2WWHKDT9FJHUPI7VYJXWJIMM7L4VHRY45QUJRGEUKIZGELJ55AMMPIJLUUWK7EGO2XVENIEH6IRZYADFMLBOTRV65E82FFVTTB9ZI2FE116SGLBUSVE4FUTZIETSOLPMQ5IVCW5NGNZNTO5VNLEINSJAORVVCR4BLCYOY586A9KSCGFLGUVOEHYQMVWUPF1WYOBGTD6LAFV0T5WXQNZPJZPSJ74ILHKQ2G11PANG3VOVGKIXTTPIHPK6KOAFV72UEFZBFBXKQMNCA203PBDC8EZLSAASHRGBSF8RQLCMKOPSNS7PPOTNDNHWRLYITNXX4Z8SAOWMNNUW6WVVUMFPZFNR1CKH3WMPB1QOMB0F2GX4ACWIH52IHLV1XY9WHNNWI72PB9R7PZPYMYHOQQN3ISCOLQH6OUI29DQ6IB9NFACQYX82XSQTIRMBMWASU0ZZPDYHVFYNFELJMRMJABMN1U3QJDWQSSFGPSUTODKFZR3CWEZ5ZS69ZGBSTK02EAEGBNLEGXZPWUVFN6S3WXYHYZAWHESJVJW5JB1ODFXWHPMKINWO8X783YW0MHQFGVESGTZI44MSNOEL93QRJ3ND1JASE7DPVZREVXKUBLSUJB35F1G9TSJFPH23Q3L8B4MDFPXMSX1ZHFEPYZHEFAQERRNTU4NAOPH74TYASZMRT0GQO8E2ZVXVMSPXLVNGT8JZQ2ZMQ4GURCUMEPWQGWXJ8RNUQWMBKGVUOKRVXVSAYQ26FAKVA2UR1UFNYOPYHPAXCTOECV1EXU6UTLN4BA6W76RIOTUEAKHHAFLCV7YFFPZK62CYI0KX=XYT1HL9VBM1UTUI9DYIPZV1XH34LUTRSLVILRXWXR5PGYFQLAJ7UZNQUDPCWT9XC2ZS41IG96OGOCPMIBHOSG7OUQA5MRWC3DJL6EHPWIMYLAPGOAGGZ2T9YKQH0XT4SNMSELG2OOC1MD8ETEWD0ZOJXIWEY6GQCN6MCF62TZOY5KFVV8ZIPBFEOXCNSIMBDNNMXRLSIQDZR555E7GJ1X6FONBM3MMJH1EVX1HZ1UTPCDPVRVKB60E1NUN14DB54PPTLMI3ZCNRGXFVUIBHBL4O83PF6P4SBZMTUEHFPCOCBFBZC2LWBJ6WWTACOW8MBDLZZPBMAM6CCFAQTHFI9KPPLPGGTLXP8HCY75X61X2FJ7H2OHEXVPO2L4GWP1BNQYAWAVJ592L8QGKLRIASFUYDJ2ZZGUY2YWBFYSRTDZRW3CSJNTOKHZ5YWB95JATASRH9INMXLT4NK6IJOOSALHJM7BY2FPGAO5YOCKY4JTIOTNSWVK3P2OB2GO56PBOSWNNECR7BVY9HJISO4WKW0LNJXG1OTKHX2XHAKLTQTOFHMSSRPQFWELCPT3FQUA9PIAJZUJJHZMMRGFC1T0ZZD6VMLVFIMWHKKCFAUZCX0US7JVTKWSCQEAINX2E2WYZPYEBDANJJTRA81QVHASGHHB8GYKECU8IAJYVCXB14K2M5APH85PUR8YUFEBCYCICELNF3VX1QMTJHAOZUWY67VTGPPTFTIMBH58LVDQLYAUZMNPGK2TK1HCKSPPJXGPEEILSRWO7JIW3QHFAVO9ZHRI7CXNUFIYR";
int N = 30;
bool LEX = 1;

class StringOptions : public Options {

public:

  StringOptions(const char* s): Options(s) {
      //this->c_d(1);
  }

};

/*
* Determine N distinct substrings w_1, ..., w_N of W such that each w_i is
* palindrome and |w_i| > 1 for each i in {1, ..., k}.
*/
class LexPalindrome : public Script {

  StringVarArray string_vars;
  IntVarArray int_vars;

public:


  LexPalindrome(LexPalindrome& s): Script(s) {
    string_vars.update(*this, s.string_vars);
    int_vars.update(*this, s.int_vars);
  }
  virtual Space* copy() {
    return new LexPalindrome(*this);
  }

  LexPalindrome(const StringOptions& so): Script(so) {
    // Variables.
    IntVarArgs iva;
    StringVarArgs sva;
    int l = W.size(), n = l - 2 * (N - 1);
    StringVar w(*this, W);
    IntVar zero(*this, 0, 0);
    for (int i = 0; i < N; ++i) {
      StringVar wi(*this, 2, n);
      IntVar k(*this, 1, l - 1);
      sva << wi;
      iva << k;
      find(*this, wi, w, k);
      rel(*this, wi, STRT_REV, wi);
      if (i > 0) {
        if (LEX)
          rel(*this, sva[i - 1], STRT_LEXLT, wi);
        else
          for (int j = i; j > 0; --j)
            rel(*this, sva[j - 1], STRT_NQ, wi);
      }
    }
    int_vars = IntVarArray(*this, iva);
    string_vars = StringVarArray(*this, sva);
    sizemin_llul(*this, sva);
  }

  virtual void
  print(std::ostream& os) const {
  for (auto& w : string_vars)
    os << w << "\n";
  N = -1;
  }

};

int main() {
  StringOptions opt("*** Lex palindrome ***");
  opt.solutions(1);
  Script::run<LexPalindrome, DFS, StringOptions>(opt);
  assert (N == -1);
  return 0;
}
